version: 2
jobs:
  build:
    filters:
      tags:
        only: /v[0-9]+\.[0-9]+\.[0-9]+/
      branches:
        only: master
    machine: true
    steps:
     - checkout
     - run: docker login -u $DOCKER_USER -p $DOCKER_PASS
     # build the application image
     - run: docker build -t deissh/avagen:$CIRCLE_TAG .
     # deploy the image
     - run: docker push deissh/avagen:$CIRCLE_TAG
